/*C427*/SET SCHEMA PUBLIC
CONNECT USER SA
 /**   * Creates the database used by MagusWeb (prefix MW_).  */ /***************************************************************************  * Table  : MW_DATABASE  * Purpose: Store MagusWeb supported databases.  ***************************************************************************/ DROP TABLE IF EXISTS MW_DATABASE CASCADE
 /*CREATE TABLE MW_DATABASE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,    name VARCHAR(40) not null,   CONSTRAINT db_uniq_name unique(name) ) */ /***************************************************************************  * Table  : MW_SERVER  * Purpose: Store MagusWeb supported servers.  ***************************************************************************/ DROP TABLE IF EXISTS MW_SERVER CASCADE
 /*CREATE TABLE MW_SERVER (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,    NAME VARCHAR(80) not null,   CONSTRAINT srv_uniq_name unique(name) ) */ /***************************************************************************  * Table  : MW_APPLICATION  * Purpose: Store MagusWeb generated applications.   ***************************************************************************/ DROP TABLE IF EXISTS MW_APPLICATION CASCADE
 CREATE TABLE MW_APPLICATION (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,    name VARCHAR(80) not null,   short_name VARCHAR(80) not null,   description varchar(4000) null,   path varchar(150) not null,   java_package varchar(60) null,   class_path varchar(500) null,   src_folder varchar(60) null,   copyright varchar(200),   license_file varchar(100),   template varchar(50),   records_per_page integer,   user varchar(50),   CONSTRAINT apb_uniq_name unique(name) ) 
 /***************************************************************************  * Table  : APPLICATION_SERVER  * Purpose: Store target server used in the generated application.  ***************************************************************************/ DROP TABLE IF EXISTS MW_APPLICATION_SERVER CASCADE
 CREATE TABLE MW_APPLICATION_SERVER (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,    app_id integer not null,   /*server_id integer not null,*/   folder VARCHAR(80) not null,   manager_url varchar(150) not null,   username varchar(20) not null,   password varchar(20),   CONSTRAINT FK_APPSERV_APP FOREIGN KEY (app_id) REFERENCES MW_APPLICATION (ID)   /*CONSTRAINT FK_APPSERV_SER FOREIGN KEY (server_id) REFERENCES MW_SERVER (ID)*/ ) 
 /***************************************************************************  * Table  : MW_APPLICATION_DATABASE  * Purpose: Store target database used in the generated application.  ***************************************************************************/ DROP TABLE IF EXISTS MW_APPLICATION_DATABASE CASCADE
 CREATE TABLE MW_APPLICATION_DATABASE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   app_id integer not null,   /*db_id integer not null,*/   db_type varchar(30) not null,   data_source varchar(60) not null,   driver varchar(60) not null,   connection_string varchar(80) not null,   connection_impl varchar(200) not null,   username varchar(20) not null,   password varchar(20),   CONSTRAINT FK_APPDAT_APP FOREIGN KEY (app_id) REFERENCES MW_APPLICATION (ID)   /*CONSTRAINT FK_APPDAT_DB FOREIGN KEY (db_id) REFERENCES MW_DATABASE (ID)*/ ) 
 /***************************************************************************  * Table  : MW_MENU  * Purpose: Store menu entries for a new application.  ***************************************************************************/ DROP TABLE IF EXISTS MW_MENU CASCADE
 CREATE TABLE MW_MENU (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   parent_menu_id integer,   app_id integer not null,   name VARCHAR(40) not null,   link VARCHAR(100) null,   CONSTRAINT FK_APPMEN_APP FOREIGN KEY (app_id) REFERENCES MW_APPLICATION (ID),   CONSTRAINT FK_PARENTMENU_MENU FOREIGN KEY (parent_menu_id) REFERENCES MW_MENU (id) ) 
 /***************************************************************************  * Table      : MW_PARAMETER  * Purpose    : Store parameter values for Magus operation  ***************************************************************************/ DROP TABLE IF EXISTS MW_PARAMETER CASCADE
 /*CREATE TABLE MW_PARAMETER (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   parameter varchar(100) not null,   value varchar(500) not null,   description varchar(2000) null,   CONSTRAINT param_uniq_name unique(parameter) ) */ /***************************************************************************  * Table      : MW_TABLE  * Purpose    : Store meta data information for the tables used to create a   *              new application.  * Description: alias column is used for application generated code.  *   *              label column is a key for i18n support (see messages files   *              in src/resources).  ***************************************************************************/ DROP TABLE IF EXISTS MW_TABLE CASCADE
 CREATE TABLE MW_TABLE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   app_id integer not null,   catalog VARCHAR(40) not null,   schema VARCHAR(40) not null,   name VARCHAR(40) not null,   alias VARCHAR(40),   label VARCHAR(100),    orderby VARCHAR(40),   export_keys boolean,   CONSTRAINT table_uniq_name unique(app_id,name),   CONSTRAINT FK_TAB_APP FOREIGN KEY (app_id) REFERENCES MW_APPLICATION (ID) ) 
 /***************************************************************************  * Table      : MW_FIELD  * Purpose    : Store meta data information for the tables' fields used to   *              create a new application.  * Description: label column is a key for i18n support (see messages files   *              in src/resources).  *   *              visible - 'Y' (everywhere)  *                      - 'F' (create/update only)  ***************************************************************************/ DROP TABLE IF EXISTS MW_FIELD CASCADE
 CREATE TABLE MW_FIELD (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   table_id integer not null,   NAME VARCHAR(40) not null,   label VARCHAR(100) not null,   display_order integer,   type integer,   mask varchar(50),   comment varchar(2000),   filter char(1) default 'N',   visible char(1) default 'Y',   CONSTRAINT FK_FLD_TBL FOREIGN KEY (table_id) REFERENCES MW_TABLE (id),   CONSTRAINT field_uniq_name unique(table_id,name) ) 
 DROP TABLE IF EXISTS MW_FIELD_OPTION CASCADE
 CREATE TABLE MW_FIELD_OPTION (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   field_id integer not null,   value VARCHAR(40) not null,   text VARCHAR(100) not null,   display_order integer,   CONSTRAINT FK_FLD_OPT_TBL FOREIGN KEY (field_id) REFERENCES MW_FIELD (id),   CONSTRAINT field_opt_uniq_name unique(field_id,value) ) 
INSERT INTO MW_APPLICATION VALUES(1,'Sample Application','sampleapp','Sample application to test the application generator.','C:/apache-tomcat-7.0.53/webapps/sampleapp',NULL,NULL,NULL,NULL,NULL,'black',NULL,NULL)
INSERT INTO MW_APPLICATION_DATABASE VALUES(1,1,'HSQLDB','ds','driver','jdbc:hsqldb:hsql://localhost/magusdb','conn_url','sa','')
DISCONNECT
/*C428*/SET SCHEMA PUBLIC
CONNECT USER SA
 drop schema recipe CASCADE
CREATE SCHEMA RECIPE AUTHORIZATION DBA
SET SCHEMA RECIPE
SET SCHEMA PUBLIC
SET SCHEMA PUBLIC
 /***************************************************************************  * Table      : UNIDADE  * Purpose    :   * Description:   ***************************************************************************/ CREATE TABLE recipe.UNIDADE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   descricao varchar(50) not null,   CONSTRAINT unidade_uniq_descricao unique(descricao) ) 
 /***************************************************************************  * Table      : CATEGORIA  * Purpose    :   * Description:   ***************************************************************************/ CREATE TABLE recipe.CATEGORIA (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   descricao varchar(50) not null,   CONSTRAINT categoria_uniq_descricao unique(descricao) ) 
 /***************************************************************************  * Table      : RECEITA  * Purpose    :   * Description: O campo descricao serve para a pregui\u00e7a de cadastrar ingrediente por ingrediente.  *              Derivar o preco total e calorias total baseado na lista de ingredientes  ***************************************************************************/ CREATE TABLE recipe.RECEITA (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   categoria_id integer not null,   nome varchar(50) not null,   origem varchar(50) null,   rendimento varchar(50) null,   valor varchar(50) null,   tempo_preparo varchar(50) null,   nota varchar(50) null,   fonte varchar(50) null,   dificuldade varchar(20) null,   descricao longvarchar null,   modo_preparo longvarchar null,   foto binary null,   arquivo binary null,   CONSTRAINT receita_uniq_nome unique(nome),   CONSTRAINT fk_receita_categoria FOREIGN KEY (categoria_id) REFERENCES recipe.CATEGORIA (id) ) 
 /***************************************************************************  * Table      : INGREDIENTE  * Purpose    :   * Description:   ***************************************************************************/ CREATE TABLE recipe.INGREDIENTE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   unidade_id integer null,   nome varchar(50) not null,   porcao varchar(50) null,   preco decimal(10,2) null,   calorias_porcao double null,   CONSTRAINT ingrediente_uniq_nome unique(nome),   CONSTRAINT fk_ingrediente_unidade FOREIGN KEY (unidade_id) REFERENCES recipe.UNIDADE (id) ) 
 /***************************************************************************  * Table      : RECEITA_INGREDIENTE  * Purpose    :   * Description:   ***************************************************************************/ CREATE TABLE recipe.RECEITA_INGREDIENTE (   id integer GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null,   receita_id integer not null,   ingrediente_id integer null,   unidade_id integer null,   quantidade varchar(50) null,   CONSTRAINT fk_receita_ingrediente_areceita FOREIGN KEY (receita_id) REFERENCES recipe.RECEITA (id),   CONSTRAINT fk_receita_ingrediente_ingrediente FOREIGN KEY (ingrediente_id) REFERENCES recipe.INGREDIENTE (id),   CONSTRAINT fk_receita_ingrediente_unidade FOREIGN KEY (unidade_id) REFERENCES recipe.UNIDADE (id) ) 
SET SCHEMA RECIPE
INSERT INTO CATEGORIA VALUES(1,'Bebida')
INSERT INTO CATEGORIA VALUES(2,'Sobremesa')
INSERT INTO CATEGORIA VALUES(3,'Torta')
INSERT INTO UNIDADE VALUES(1,'Gramas')
INSERT INTO UNIDADE VALUES(2,'Colher de ch\u00e1')
INSERT INTO UNIDADE VALUES(3,'Colher de sopa')
SET SCHEMA PUBLIC
DISCONNECT
/*C429*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C430*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C431*/SET SCHEMA PUBLIC
CONNECT USER SA
INSERT INTO MW_APPLICATION VALUES(2,'recipe','recipe','','C:/apache-tomcat-7.0.53/webapps/recipe',NULL,NULL,NULL,NULL,NULL,'pure',NULL,NULL)
/*C432*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C431*/INSERT INTO MW_APPLICATION_DATABASE VALUES(2,2,'HSQLDB','ds','driver','jdbc:hsqldb:hsql://localhost/magusdb','connimpl','sa','')
/*C433*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C434*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C431*/INSERT INTO MW_TABLE VALUES(1,2,'DBREADER_CATALOG','RECIPE','CATEGORIA',NULL,NULL,NULL,NULL)
/*C432*/INSERT INTO MW_FIELD VALUES(1,1,'DESCRICAO','descricao',2,0,'','','N','Y')
/*C431*/INSERT INTO MW_FIELD VALUES(2,1,'ID','id',1,0,'','','N','Y')
INSERT INTO MW_TABLE VALUES(2,2,'DBREADER_CATALOG','RECIPE','INGREDIENTE',NULL,NULL,NULL,NULL)
/*C432*/INSERT INTO MW_FIELD VALUES(3,2,'UNIDADE_ID','unidadeId',2,3,'','','N','Y')
/*C431*/INSERT INTO MW_FIELD VALUES(4,2,'PORCAO','porcao',4,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(5,2,'PRECO','preco',5,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(6,2,'CALORIAS_PORCAO','caloriasPorcao',6,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(7,2,'ID','id',1,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(8,2,'NOME','nome',3,0,'','','N','Y')
INSERT INTO MW_TABLE VALUES(3,2,'DBREADER_CATALOG','RECIPE','RECEITA',NULL,NULL,NULL,NULL)
/*C432*/INSERT INTO MW_FIELD VALUES(9,3,'CATEGORIA_ID','categoriaId',2,3,'','','N','Y')
/*C431*/INSERT INTO MW_FIELD VALUES(10,3,'DESCRICAO','descricao',11,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(11,3,'RENDIMENTO','rendimento',5,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(12,3,'DIFICULDADE','dificuldade',10,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(13,3,'FONTE','fonte',9,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(14,3,'NOTA','nota',8,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(15,3,'ID','id',1,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(16,3,'FOTO','foto',13,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(17,3,'MODO_PREPARO','modoPreparo',12,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(18,3,'TEMPO_PREPARO','tempoPreparo',7,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(19,3,'ORIGEM','origem',4,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(20,3,'VALOR','valor',6,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(21,3,'NOME','nome',3,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(22,3,'ARQUIVO','arquivo',14,0,'','','N','Y')
/*C435*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C436*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C437*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C438*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C439*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C440*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C441*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C442*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C431*/INSERT INTO MW_TABLE VALUES(4,2,'DBREADER_CATALOG','RECIPE','RECEITA_INGREDIENTE',NULL,NULL,NULL,NULL)
/*C432*/INSERT INTO MW_FIELD VALUES(23,4,'UNIDADE_ID','unidadeId',4,3,'','','N','Y')
/*C431*/INSERT INTO MW_FIELD VALUES(24,4,'QUANTIDADE','quantidade',5,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(25,4,'RECEITA_ID','receitaId',2,3,'','','N','Y')
INSERT INTO MW_FIELD VALUES(26,4,'ID','id',1,0,'','','N','Y')
INSERT INTO MW_FIELD VALUES(27,4,'INGREDIENTE_ID','ingredienteId',3,3,'','','N','Y')
INSERT INTO MW_TABLE VALUES(5,2,'DBREADER_CATALOG','RECIPE','UNIDADE',NULL,NULL,NULL,NULL)
/*C432*/INSERT INTO MW_FIELD VALUES(28,5,'DESCRICAO','descricao',2,0,'','','N','Y')
/*C431*/INSERT INTO MW_FIELD VALUES(29,5,'ID','id',1,0,'','','N','Y')
SET AUTOCOMMIT FALSE
DELETE FROM MW_FIELD WHERE ID=29
INSERT INTO MW_FIELD VALUES(29,5,'ID','id',1,0,'','','N','Y')
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
DELETE FROM MW_FIELD WHERE ID=28
INSERT INTO MW_FIELD VALUES(28,5,'DESCRICAO','descricao',2,0,'','','N','Y')
SET AUTOCOMMIT TRUE
/*C443*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C444*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C445*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C446*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C447*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C448*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C449*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C450*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C451*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C452*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C434*/DISCONNECT
/*C431*/DISCONNECT
/*C452*/DISCONNECT
/*C450*/DISCONNECT
/*C432*/DISCONNECT
/*C448*/DISCONNECT
/*C444*/DISCONNECT
/*C446*/DISCONNECT
/*C442*/DISCONNECT
/*C440*/DISCONNECT
/*C438*/DISCONNECT
/*C436*/DISCONNECT
/*C453*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C454*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C455*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C456*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C457*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C458*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C459*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C460*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C461*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C462*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C463*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C464*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C465*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C466*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C467*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C468*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C469*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C470*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C471*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C472*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C473*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C474*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C475*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C476*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C477*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C478*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C476*/DISCONNECT
/*C474*/DISCONNECT
/*C472*/DISCONNECT
/*C470*/DISCONNECT
/*C468*/DISCONNECT
/*C466*/DISCONNECT
/*C464*/DISCONNECT
/*C462*/DISCONNECT
/*C460*/DISCONNECT
/*C458*/DISCONNECT
/*C479*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C480*/SET SCHEMA PUBLIC
CONNECT USER SA
/*C481*/SET SCHEMA PUBLIC
CONNECT USER SA
SET SCHEMA RECIPE
INSERT INTO CATEGORIA VALUES(4,'aa')
SET SCHEMA PUBLIC
SET AUTOCOMMIT FALSE
SET SCHEMA RECIPE
DELETE FROM CATEGORIA WHERE ID=4
INSERT INTO CATEGORIA VALUES(4,'aax')
SET SCHEMA PUBLIC
SET AUTOCOMMIT TRUE
SET SCHEMA RECIPE
DELETE FROM CATEGORIA WHERE ID=4
